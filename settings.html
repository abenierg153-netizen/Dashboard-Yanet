<!DOCTYPE html>
<html lang="en" x-data="{ activeTab: 'profile' }">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Settings - Yanet Dental Clinic</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- AlpineJS -->
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="bg-gray-50">

  <!-- Header -->
  <header class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-50">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 flex justify-between items-center py-3">
      <h1 class="text-xl font-bold text-blue-600 flex items-center">
        <i class="fas fa-tooth mr-2"></i> Settings
      </h1>
      <a href="index.html" class="text-sm text-blue-500 hover:underline">‚Üê Back to Dashboard</a>
    </div>
  </header>

  <!-- Flash Messages -->
  <div id="flashMsg" class="hidden fixed top-20 right-5 bg-green-500 text-white px-4 py-2 rounded shadow">
  </div>

  <!-- Content -->
  <div class="max-w-4xl mx-auto p-4">

    <!-- Tabs -->
    <div class="flex space-x-4 border-b mb-6">
      <template x-for="tab in ['profile','users','appointments','services','system']">
        <button 
          @click="activeTab = tab" 
          :class="activeTab===tab ? 'border-b-2 border-blue-500 text-blue-600' : 'text-gray-600'"
          class="pb-2 capitalize">
          <span x-text="tab"></span>
        </button>
      </template>
    </div>

    <!-- Profile & Security -->
    <div x-show="activeTab === 'profile'" class="space-y-4">
      <h2 class="text-lg font-semibold">Admin Profile</h2>
      <form id="profileForm" class="space-y-3" onsubmit="saveForm('profileForm'); return false;">
        <input id="profile_name" type="text" placeholder="Admin Name" class="w-full p-2 border rounded">
        <input id="profile_email" type="email" placeholder="Email" class="w-full p-2 border rounded">
        <input id="profile_pass" type="password" placeholder="New Password" class="w-full p-2 border rounded">
        <button class="px-4 py-2 bg-blue-600 text-white rounded">Save Changes</button>
      </form>
    </div>

    <!-- User Management -->
    <div x-show="activeTab === 'users'" class="space-y-4">
      <h2 class="text-lg font-semibold">User Accounts</h2>
      <button class="px-3 py-2 bg-green-600 text-white rounded" onclick="showFlash('New user form will pop up')">
        + Add New User
      </button>
      <table class="w-full border mt-4">
        <thead class="bg-gray-100">
          <tr>
            <th class="p-2 text-left">Name</th>
            <th class="p-2 text-left">Role</th>
            <th class="p-2 text-left">Actions</th>
          </tr>
        </thead>
        <tbody id="userTable">
          <!-- Example -->
          <tr class="border-b">
            <td class="p-2">Dr. Tesfaye</td>
            <td class="p-2">Dentist</td>
            <td class="p-2">
              <button class="text-blue-500" onclick="showFlash('Edit User feature')">Edit</button> | 
              <button class="text-red-500" onclick="showFlash('User Deleted')">Delete</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Appointments -->
    <div x-show="activeTab === 'appointments'" class="space-y-4">
      <h2 class="text-lg font-semibold">Appointment Settings</h2>
      <form id="apptForm" class="space-y-3" onsubmit="saveForm('apptForm'); return false;">
        <input id="appt_max" type="number" placeholder="Max Patients per Day" class="w-full p-2 border rounded">
        <input id="appt_open" type="time" class="w-full p-2 border rounded">
        <input id="appt_close" type="time" class="w-full p-2 border rounded">
        <button class="px-4 py-2 bg-blue-600 text-white rounded">Save</button>
      </form>
    </div>

    <!-- Services & Pricing -->
    <div x-show="activeTab === 'services'" class="space-y-4">
      <h2 class="text-lg font-semibold">Service Pricing</h2>
      <form id="serviceForm" class="space-y-3" onsubmit="saveForm('serviceForm'); return false;">
        <input id="service_name" type="text" placeholder="Service Name" class="w-full p-2 border rounded">
        <input id="service_price" type="number" placeholder="Price (ETB)" class="w-full p-2 border rounded">
        <button class="px-4 py-2 bg-green-600 text-white rounded">+ Add Service</button>
      </form>
      <table class="w-full border mt-4">
        <thead class="bg-gray-100">
          <tr>
            <th class="p-2 text-left">Service</th>
            <th class="p-2 text-left">Price (ETB)</th>
          </tr>
        </thead>
        <tbody id="serviceTable"></tbody>
      </table>
    </div>

    <!-- System Preferences -->
    <div x-show="activeTab === 'system'" class="space-y-4">
      <h2 class="text-lg font-semibold">System Preferences</h2>
      <form id="systemForm" class="space-y-3" onsubmit="saveForm('systemForm'); return false;">
        <select id="system_lang" class="w-full p-2 border rounded">
          <option>English</option>
          <option>Amharic</option>
        </select>
        <select id="system_time" class="w-full p-2 border rounded">
          <option>24-hour format</option>
          <option>12-hour format</option>
        </select>
        <button class="px-4 py-2 bg-blue-600 text-white rounded">Save Preferences</button>
      </form>
    </div>

  </div>

  <!-- Simple Vanilla JS Helpers -->
  <script>
    function showFlash(msg) {
      const flash = document.getElementById("flashMsg");
      flash.innerText = msg;
      flash.classList.remove("hidden");
      setTimeout(() => flash.classList.add("hidden"), 3000);
    }

    // Save form data to localStorage
    function saveForm(formId) {
      const form = document.getElementById(formId);
      const data = {};
      [...form.elements].forEach(el => {
        if (el.id) data[el.id] = el.value;
      });
      localStorage.setItem(formId, JSON.stringify(data));
      showFlash("Saved!");
      renderTables(); // refresh services/users if needed
    }

    // Load form data on startup
    function loadForms() {
      ["profileForm", "apptForm", "serviceForm", "systemForm"].forEach(id => {
        const saved = localStorage.getItem(id);
        if (saved) {
          const data = JSON.parse(saved);
          Object.keys(data).forEach(key => {
            const el = document.getElementById(key);
            if (el) el.value = data[key];
          });
        }
      });
      renderTables();
    }

    // Render services dynamically
    function renderTables() {
      const services = localStorage.getItem("serviceForm");
      if (services) {
        const data = JSON.parse(services);
        if (data.service_name && data.service_price) {
          document.getElementById("serviceTable").innerHTML = `
            <tr class="border-b">
              <td class="p-2">${data.service_name}</td>
              <td class="p-2">${data.service_price}</td>
            </tr>
          `;
        }
      }
    }

    document.addEventListener("DOMContentLoaded", loadForms);
  </script>

</body>
</html>
